
<!DOCTYPE html>
<html lang="en">
<head>

  <!-- adding favicon link tags to the head -->
  <link rel="apple-touch-icon" sizes="180x180" href="images/favicons/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="images/favicons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="images/favicons/favicon-16x16.png">
  <link rel="manifest" href="images/favicons/site.webmanifest">
  <!--for some reason, the below breaks the code highlighting in codeblocks-->
  <!-- <meta name="msapplication-TileColor" content="#da532c">  -->
  <meta name="theme-color" content="#ffffff">
  <!-- end favicons -->
  
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="robots" content="" />

  <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:ital,wght@0,400;0,700;1,400&family=Source+Sans+Pro:ital,wght@0,300;0,400;0,700;1,400&display=swap" rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="./theme/stylesheet/style.min.css">

    <link id="dark-theme-style" rel="stylesheet" type="text/css"
          media="(prefers-color-scheme: dark)"
    href="./theme/stylesheet/dark-theme.min.css">

    <link id="pygments-dark-theme" rel="stylesheet" type="text/css"
              media="(prefers-color-scheme: dark)"
          href="./theme/pygments/monokai.min.css">
    <link id="pygments-light-theme" rel="stylesheet" type="text/css"
              media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"
          href="./theme/pygments/github.min.css">


  <link rel="stylesheet" type="text/css" href="./theme/font-awesome/css/fontawesome.css">
  <link rel="stylesheet" type="text/css" href="./theme/font-awesome/css/brands.css">
  <link rel="stylesheet" type="text/css" href="./theme/font-awesome/css/solid.css">





  


 

<meta name="author" content="Freddie Larkins" />
<meta name="description" content="I wrote a few Python scripts that monitor your site&#39;s most important URLs for any 4xx and 5xx errors. Here&#39;s how they work." />
<meta name="keywords" content="Search Console API, cron, requests">


  <meta property="og:site_name" content="Freddie's SEO Blog ://"/>
  <meta property="og:title" content="Monitoring your site&#39;s most important URLs with Python"/>
  <meta property="og:description" content="I wrote a few Python scripts that monitor your site&#39;s most important URLs for any 4xx and 5xx errors. Here&#39;s how they work."/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:url" content="./monitoring-your-site-s-most-important-urls-with-python.html"/>
  <meta property="og:type" content="article"/>
  <meta property="article:published_time" content="2022-03-19 15:09:00+00:00"/>
  <meta property="article:modified_time" content=""/>
  <meta property="article:author" content="./author/freddie-larkins.html">
  <meta property="article:section" content="Python"/>
  <meta property="article:tag" content="Search Console API"/>
  <meta property="article:tag" content="cron"/>
  <meta property="article:tag" content="requests"/>
  <meta property="og:image" content="">

  <title>Monitoring your site&#39;s most important URLs with Python | Freddie's SEO Blog ://</title>

</head>
<body >
  <aside>
    <div>
      <a href="./">
        <img src="./theme/img/profile.png" alt="Freddie Larkins" title="Freddie Larkins">
      </a>

      <h1>
        <a href="./">Freddie Larkins</a>
      </h1>

<p>SEO, Python and other stuff.</p>

      <nav>
        <ul class="list">



            <li>
              <a target="_self" href="/pdfs/freddie-larkins-cv.pdf" >cv</a>
            </li>
            <li>
              <a target="_self" href="/pages/about-me.html" >about me</a>
            </li>
        </ul>
      </nav>

      <ul class="social">
          <li>
            <a  class="sc-github" href="https://www.github.com/fredlarkins/" target="_blank">
              <i class="fab fa-github"></i>
            </a>
          </li>
          <li>
            <a  class="sc-linkedin" href="https://www.linkedin.com/in/freddielarkins/" target="_blank">
              <i class="fab fa-linkedin"></i>
            </a>
          </li>
      </ul>
    </div>

  </aside>
  <main>


<article class="single">
  <header>
      
    <h1 id="monitoring-your-site-s-most-important-urls-with-python">Monitoring your site's most important URLs with Python</h1>
    <p>
      Posted on Sat 19 March 2022 in <a href="./category/python.html">Python</a>

    </p>
  </header>


  <div>
    <p><strong>I've you've ever discovered a piece of content has been accidentally redirected or removed, this article might be for you.</strong></p>
<p>As SEOs, we're precious about our site's traffic - especially when we're losing it! The inspo for this collection of Python scripts arose at work, where I'd noticed a few pieces of traffic-driving bits of content had been accidentally redirected elsewhere, or were stuck in infinite redirect loops. Of course, in both cases, traffic loss was the result.</p>
<p>This <a href="https://github.com/fredlarkins/monitor-top-urls">GitHub repo was</a> my attempt to set up an automated monitoring system for a site's top URLs by organic clicks, checking daily for 4xx and 5xx errors and emailing you the results of the check. If you just want to go ahead and try it, run:</p>
<div class="highlight"><pre><span></span><code>git clone https://github.com/fredlarkins/monitor-top-urls.git
</code></pre></div>

<p>... and follow the README.md for set-up instructions.</p>
<p>Otherwise, here's how it works in a little more detail.</p>
<h2>Querying the Search Console API</h2>
<p>The idea behind this project was to only monitor the site's most important URLs for downtime. Therefore, the script queries the Search Console API (GSC API) for a list of the top X URLs (where X is specified by the user when invoking the script) by organic clicks.</p>
<p>The <code>query()</code> function in <code>query_search_console.py</code> does this job. Using Josh Carty's user-friendly <a href="https://github.com/joshcarty/google-searchconsole">google-searchconsole</a> package, it authenticates to the API with client_secret.json and client_config.json files - downloaded from the Google Develeoper Console. The important bit of the function is this:</p>
<div class="highlight"><pre><span></span><code><span class="n">df</span> <span class="o">=</span> <span class="n">webprop</span><span class="o">.</span><span class="n">query</span>\ <span class="c1"># webprop is a &#39;webproperty&#39; object - just like the properties you see in the GSC GUI</span>

        <span class="c1"># asks the API for the last month of data</span>
        <span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s1">&#39;today&#39;</span><span class="p">,</span> <span class="n">months</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>\

        <span class="c1"># aggregates the data by page</span>
        <span class="o">.</span><span class="n">dimension</span><span class="p">(</span><span class="s1">&#39;page&#39;</span><span class="p">)</span>\

        <span class="c1"># limits the number of URLs returned by the API to num_urls...</span>
        <span class="c1"># ... which is supplied by the user as a command-line argument</span>
        <span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="n">num_urls</span><span class="p">)</span>\

        <span class="o">.</span><span class="n">get</span><span class="p">()</span>\
        <span class="o">.</span><span class="n">to_dataframe</span><span class="p">()</span>

<span class="k">return</span> <span class="n">df</span> <span class="c1"># return the result as a DataFrame</span>
</code></pre></div>

<p>Calling <code>query()</code> supplies us with the list of URLs that are checked for errors.</p>
  </div>
  <div class="tag-cloud">
    <p>
      <a href="./tag/search-console-api.html">Search Console API</a>
      <a href="./tag/cron.html">cron</a>
      <a href="./tag/requests.html">requests</a>
    </p>
  </div>





</article>

    <footer>
<p>
  &copy;   - This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/deed.en_GB" target="_blank">Creative Commons Attribution-ShareAlike 4.0 International License</a>
</p>
<p>
Built with <a href="http://getpelican.com" target="_blank">Pelican</a> using <a href="http://bit.ly/flex-pelican" target="_blank">Flex</a> theme
  <span class="footer-separator">|</span>
  Switch to the <a href="javascript:void(0)" onclick="theme.switch(`dark`)">dark</a> | <a href="javascript:void(0)" onclick="theme.switch(`light`)">light</a> | <a href="javascript:void(0)" onclick="theme.switch(`browser`)">browser</a> theme
  <script id="dark-theme-script"
          src="./theme/dark-theme/dark-theme.min.js"
          data-enable-auto-detect-theme="True"
          data-default-theme="light"
          type="text/javascript">
  </script>
</p><p>
  <a rel="license"
     href="http://creativecommons.org/licenses/by-sa/4.0/"
     target="_blank">
    <img alt="Creative Commons License"
         title="Creative Commons License"
         style="border-width:0"
           src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png"
         width="80"
         height="15"/>
  </a>
</p>    </footer>
  </main>




<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " Freddie's SEO Blog :// ",
  "url" : ".",
  "image": "",
  "description": "Home of the ramblings of an SEO currently working for Zoopla."
}
</script>

</body>
</html>